<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Modeling Pupil Responses | Jacob A. Parker </title> <meta name="author" content="Jacob A. Parker"> <meta name="description" content="A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design. "> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?b05f9a0b7405d7c8c89c7465593dea81"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?dadeb9c5d1fd12bc8d37475657446863"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?1fefb6021bf36010f25ea1cef24af84e"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Playfair+Display:ital,wght@0,400,500,700;1,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?53a094b51ed1d1e025731eb00d240058" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/gumbel_favicon3.jpg?ac441f4fdac3ce13e1fe9a499bd8746d"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://jacobaparker.github.io/projects/modeling-pupil-responses/"> <script src="/assets/js/theme.js?f2531f05c6f8e1622518f4f5a1e385b1"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?46af317e693b09921dcb92261d123fbc" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title" href="/"> Jacob A. Parker </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/research/">research </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Modeling Pupil Responses</h1> <p class="post-description"></p> </header> <article> <p>This is the project I worked on as an undergraduate research assistant in the <a href="https://wp.nyu.edu/carrascolab/" rel="external nofollow noopener" target="_blank">Carrasco lab</a>. The following is adapted from a <a href="https://x.com/jake_a_parker/status/1282730895624085506" rel="external nofollow noopener" target="_blank">Twitter thread</a> that was originally posted on July 13, 2020.</p> <p><br></p> <h2 id="summary">Summary</h2> <hr> <p>Pupil size is an indicator of various cognitive processes, making it potentially useful for assessing task-related processing dynamics. <a href="https://sites.bu.edu/denisonlab/" rel="external nofollow noopener" target="_blank">Rachel Denison</a>, <a href="https://wp.nyu.edu/carrascolab/" rel="external nofollow noopener" target="_blank">Marisa Carrasco</a>, and I developed a model that allows one to evaluate these dynamics by linking pupil responses to trial events <a class="citation" href="#denisonModelingPupilResponses2020">(Denison* et al., 2020)</a>.</p> <div style="display: flex; justify-content: center;"> <figure style="width: 70%; max-width: 930px; min-width: 300px; margin: 0 auto;"> <img src="/assets/img/publication_preview/PRET.gif" alt="Animation of the pupil resonse model fitting procedure" style="width: 100%; height: auto; display: block;" data-zoomable="" loading="lazy"> <figcaption style="text-align: center; font-size: 0.9em;"> Pupil responses to individual events (colored curves) being fit to an artificial pupil area time series. </figcaption> </figure> </div> <p><br></p> <p>We created an open-source Matlab toolbox (Pupil Response Estimation Toolbox - PRET) that allows one to easily model pupil responses:</p> <div class="repositories d-flex flex-wrap flex-md-row flex-column justify-content-between align-items-center"> <div class="repo p-2 text-center"> <a href="https://github.com/jacobaparker/PRET" rel="external nofollow noopener" target="_blank"> <img class="only-light w-100" alt="jacobaparker/PRET" src="https://github-readme-stats.vercel.app/api/pin/?username=jacobaparker&amp;repo=PRET&amp;theme=default&amp;locale=en&amp;show_owner=true&amp;description_lines_count=2"> <img class="only-dark w-100" alt="jacobaparker/PRET" src="https://github-readme-stats.vercel.app/api/pin/?username=jacobaparker&amp;repo=PRET&amp;theme=dark&amp;locale=en&amp;show_owner=true&amp;description_lines_count=2"> </a> </div> </div> <p><br></p> <h2 id="more-details">More Details</h2> <hr> <p>The dynamics of pupil dilation are sluggish, taking ~1 sec to fully dilate in response to an internal cognitive signal (tmax below - units in ms). When many such signals occur within 1-2 secs, it is difficult to attribute changes in pupil size to any single signal.</p> <div style="display: flex; justify-content: center;"> <figure style="width: 50%; max-width: 930px; min-width: 300px; margin: 0 auto;"> <img src="/assets/img/prf.png" alt="Pupil response function" style="width: 100%; height: auto; display: block;" data-zoomable="" loading="lazy"> </figure> </div> <p><br></p> <p>This challenge has been previously addressed using a modeling paradigm that assumes that trial events elicit internal cognitive signals that drive pupil dilation responses, and that the measured pupil size time series is the linear combination of these pupil responses. The pupil response to an instantaneous cognitive signal is given by the pupil response function (A). Convolution of this function with the cognitive signals presumed to be associated with each trial event (B) gives the estimated pupil responses (C).</p> <div style="display: flex; justify-content: center;"> <figure style="width: 40%; max-width: 930px; min-width: 300px; margin: 0 auto;"> <img src="/assets/img/pupil-modeling-theory.png" alt="Figure with subplots showing how pupil responses to individual events are modeled when the events occur close together in time" style="width: 100%; height: auto; display: block;" data-zoomable="" loading="lazy"> </figure> </div> <p><br></p> <p>Estimating model parameters (i.e. cognitive signal amplitudes) by fitting to pupil size data recorded during task completion allows one to make inferences about the cognitive signals related to each trial event. This approach is very similar to the general linear model framework used in many task fMRI analyses, where the hemodynamic response function is analogous to the pupil response function.</p> <p>Despite the promising utility of this approach to pupil modeling, no standard procedure exists for implementing it. Various combinations of model elements and parameters have been tried, with cognitive signal amplitude being the only commonality. We conducted a factorial model comparison to determine what model elements/parameters should be included by fitting all possible models (24) to pupil size data from two temporal attention experiments. The model with the lowest BIC for the most observers was our criteria.</p> <p>This comparison suggested that pupil dynamics are highly variable across individuals, and that modeling this inter-observer variability is imperative. Model fits improved significantly when the pupil response function (tmax parameter) was fit for each observer.</p> <div style="display: flex; justify-content: center;"> <figure style="width: 90%; max-width: 930px; min-width: 300px; margin: 0 auto;"> <img src="/assets/img/pupil-model-comparison.png" alt="A plot comparing how well 24 different pupil response models fit individual subjects" style="width: 100%; height: auto; display: block;" data-zoomable="" loading="lazy"> </figure> </div> <p><br></p> <p>In fact, model parameters generally tended to be more consistent across task conditions within individuals than across individuals within task conditions. This further underscores the need to account for individual variability.</p> <div style="display: flex; justify-content: center;"> <figure style="width: 90%; max-width: 930px; min-width: 300px; margin: 0 auto;"> <img src="/assets/img/pupil-individual-differences.png" alt="A plot showing parameter fits for all subjects and conditions" style="width: 100%; height: auto; display: block;" data-zoomable="" loading="lazy"> </figure> </div> <p><br></p> <p>We also found that cognitive signals should not be assumed to occur simultaneously with the associated trial event. When we included a time shift parameter (latency) for each cognitive signal in the model, the fit improved significantly (see above). Such a time shift was found when fitting the winning model to our data. Specifically, we found that pupil dilation anticipated predictable trial events – see precue and T1 in panel B.</p> <div style="display: flex; justify-content: center;"> <figure style="width: 50%; max-width: 930px; min-width: 300px; margin: 0 auto;"> <img src="/assets/img/pupil-parameter-estimates.png" alt="Group mean parameter estimates for the winning model" style="width: 100%; height: auto; display: block;" data-zoomable="" loading="lazy"> </figure> </div> <p><br></p> <p>Finally, we found that event-related pupil dilation amplitudes were larger for all trial events in the discrimination task as opposed to the estimation task – see panel A directly above (experimental design between these two tasks was identical apart from report type).</p> <p>For more information about the experimental procedure, parameter estimation, model validation, reliability of parameter estimates, and more, check out the paper, <a href="https://link.springer.com/article/10.3758/s13428-020-01368-6" rel="external nofollow noopener" target="_blank">Modeling pupil responses to rapid sequential events.</a></p> <p><br></p> </article> <h2>References</h2> <div class="publications"> <h2 class="bibliography">2020</h2> <ol class="bibliography"><li> <div class="row"> <div class="col col-sm-2 abbr"> <abbr class="badge rounded w-100">Behav. Res.</abbr> <figure> <picture> <img src="/assets/img/publication_preview/PRET.gif" class="preview z-depth-1 rounded" width="100%" height="auto" alt="PRET.gif" data-zoomable loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div id="denisonModelingPupilResponses2020" class="col-sm-8"> <div class="title">Modeling Pupil Responses to Rapid Sequential Events</div> <div class="author"> Rachel N. Denison<sup>*</sup>, <em>Jacob A. Parker<sup>*</sup></em>, and Marisa Carrasco </div> <div class="periodical"> <em>Behavior Research Methods</em>, Mar 2020 </div> <div class="periodical"> *equal contribution </div> <div class="links"> <a class="abstract btn btn-sm z-depth-0" role="button">Abs</a> <a href="https://doi.org/10.3758/s13428-020-01368-6" class="btn btn-sm z-depth-0" role="button" rel="external nofollow noopener" target="_blank">DOI</a> </div> <div class="abstract hidden"> <p>Pupil size is an easily accessible, noninvasive online indicator of various perceptual and cognitive processes. Pupil measurements have the potential to reveal continuous processing dynamics throughout an experimental trial, including anticipatory responses. However, the relatively sluggish (~2 s) response dynamics of pupil dilation make it challenging to connect changes in pupil size to events occurring close together in time. Researchers have used models to link changes in pupil size to specific trial events, but such methods have not been systematically evaluated. Here we developed and evaluated a general linear model (GLM) pipeline that estimates pupillary responses to multiple rapid events within an experimental trial. We evaluated the modeling approach using a sample dataset in which multiple sequential stimuli were presented within 2-s trials. We found: (1) Model fits improved when the pupil impulse response function (PuRF) was fit for each observer. PuRFs varied substantially across individuals but were consistent for each individual. (2) Model fits also improved when pupil responses were not assumed to occur simultaneously with their associated trial events, but could have non-zero latencies. For example, pupil responses could anticipate predictable trial events. (3) Parameter recovery confirmed the validity of the fitting procedures, and we quantified the reliability of the parameter estimates for our sample dataset. (4) A cognitive task manipulation modulated pupil response amplitude. We provide our pupil analysis pipeline as open-source software (Pupil Response Estimation Toolbox: PRET) to facilitate the estimation of pupil responses and the evaluation of the estimates in other datasets.</p> </div> </div> </div> </li></ol> </div> </div> </div> <footer class="sticky-bottom mt-5" role="contentinfo"> <div class="container"> © Copyright 2025 Jacob A. Parker. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?c999e8c5281874b7534e3352f835d4c3" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?b977fe0c21b2118ed853308b1b923969"></script> <script src="/assets/js/no_defer.js?699fa7cbe3b29f831db7d5250ba3203a"></script> <script defer src="/assets/js/common.js?d3a25b46bbd2e0a751a27b173abc6e5f"></script> <script defer src="/assets/js/copy_code.js?fff63901a03063094790ffbfd4bc0cb4" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?25eff8ff4144a010e4ad7b31403102cf"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?04761245f225e3ad9e5e3f875d4e1074"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> </body> </html>